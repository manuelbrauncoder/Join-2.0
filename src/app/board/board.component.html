<main>
  <div class="headline">
    <h1 (click)="userService.addLocalUsersToFirebase()" class="v2-t1">Board</h1>
    <div class="search">
      <input type="text" class="input-field" placeholder="Find Task" />
      <button (click)="taskService.addLocalTasksToFirebase()" class="primary">
        Add task +
      </button>
    </div>
  </div>

  <div class="task-container">
    <div class="tasks-column">
      <div class="header">
        <h3>To do</h3>
        <img src="assets/img/board-plus-btn.png" alt="" />
      </div>
      <div
        id="todoList"
        [cdkDropListConnectedTo]="['feedbackList', 'progressList', 'doneList']"
        cdkDropList
        [cdkDropListData]="filterTasks('todo')"
        cdkDropListSortingDisabled
        (cdkDropListDropped)="drop($event, 'todo')"
        class="tasks"
      >
        @for (task of taskService.fireService.tasks | filterTasks: 'todo'; track
        $index) {
        <div
          class="drag-container"
          cdkDragBoundary=".task-container"
          [cdkDragStartDelay]="500"
          cdkDrag
        >
          <app-board-task-card [task]="task"></app-board-task-card>
          <div class="placeholder" *cdkDragPlaceholder></div>
        </div>
        } @empty {<app-board-task-card-empty></app-board-task-card-empty>}
      </div>
    </div>
    <div class="tasks-column">
      <div class="header">
        <h3>In progress</h3>
        <img src="assets/img/board-plus-btn.png" alt="" />
      </div>
      <div
        id="progressList"
        [cdkDropListConnectedTo]="['feedbackList', 'doneList', 'todoList']"
        cdkDropList
        [cdkDropListData]="filterTasks('progress')"
        cdkDropListSortingDisabled
        (cdkDropListDropped)="drop($event, 'progress')"
        class="tasks"
      >
        @for (task of taskService.fireService.tasks | filterTasks: 'progress';
        track $index) {

        <div
          class="drag-container"
          cdkDragBoundary=".task-container"
          [cdkDragStartDelay]="500"
          cdkDrag
        >
          <app-board-task-card [task]="task"></app-board-task-card>
          <div class="placeholder" *cdkDragPlaceholder></div>
        </div>

        } @empty {<app-board-task-card-empty></app-board-task-card-empty>}
      </div>
    </div>
    <div class="tasks-column">
      <div class="header">
        <h3>Await feedback</h3>
        <img src="assets/img/board-plus-btn.png" alt="" />
      </div>
      <div
        id="feedbackList"
        [cdkDropListConnectedTo]="['doneList', 'progressList', 'todoList']"
        cdkDropList
        [cdkDropListData]="filterTasks('feedback')"
        cdkDropListSortingDisabled
        (cdkDropListDropped)="drop($event, 'feedback')"
        class="tasks"
      >
        @for (task of taskService.fireService.tasks | filterTasks: 'feedback';
        track $index) {

        <div
          class="drag-container"
          cdkDragBoundary=".task-container"
          [cdkDragStartDelay]="500"
          cdkDrag
        >
          <app-board-task-card [task]="task"></app-board-task-card>
          <div class="placeholder" *cdkDragPlaceholder></div>
        </div>

        } @empty {<app-board-task-card-empty></app-board-task-card-empty>}
      </div>
    </div>
    <div class="tasks-column">
      <div class="header">
        <h3>Done</h3>
        <img src="assets/img/board-plus-btn.png" alt="" />
      </div>
      <div
        id="doneList"
        [cdkDropListConnectedTo]="['feedbackList', 'progressList', 'todoList']"
        cdkDropList
        [cdkDropListData]="filterTasks('done')"
        cdkDropListSortingDisabled
        (cdkDropListDropped)="drop($event, 'done')"
        class="tasks"
      >
        @for (task of taskService.fireService.tasks | filterTasks: 'done'; track
        $index) {

        <div
          class="drag-container"
          cdkDragBoundary=".task-container"
          [cdkDragStartDelay]="500"
          cdkDrag
        >
          <app-board-task-card [task]="task"></app-board-task-card>
          <div class="placeholder" *cdkDragPlaceholder></div>
        </div>

        } @empty {
        <app-board-task-card-empty></app-board-task-card-empty>
        }
      </div>
    </div>
  </div>
</main>
